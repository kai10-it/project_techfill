# 2025-7-8

# 作業内容
## コードのスタイル修正
- Rakefileのコードスタイルを修正
  - Rakefileのの先頭にマジックコメントを追加
  - Rakefileの文字列をダブルクォートからシングルクォートに置換
- ApplicationControllerのコードスタイルを修正
  - `== nil` を `nil?` に置き換え
  - 条件分岐を簡潔にするため 後置 if とガード節を適用
- ArticlesControllerのコードスタイルを修正
  - コントローラーの説明を追加
  - インデント幅を 4 から 2 に変更
  - すべてシンボルの配列を `%i[]` 記法に変更
  - 空のアクションに処理意図を示すコメントを追加
  - 行の最後の不要な空白を削除
  - 文字列をダブルクォートからシングルクォートに置換
  - 条件分岐を簡潔にするため 後置 if とガード節を適用
  - グローバル変数 $1 を Regexp.last_match(1) に置き換え
 
## RuboCopのルールを設定
- ApplicationControllerの設定
  - ApplicationController に対するコントローラー説明コメントのルールを除外
- Style/FrozenStringLiteralCommentのルールを`app/controllers/*.rb`から除外

# 振り返り
## 学び・気づき
- RuboCopのコードスタイルのルールは、ファイルによって適用したいものと、そうでないものがあることに気づいた。
そのため、公式ドキュメントを参考にしながら、`.rubocop.yml` に特定のルールを適用するファイルと、適用しないファイルを明示的に記述することにした。
- RuboCopのルールを設定する際、同じディレクトリにある `app/controllers` をそのまま指定しても、配下のファイルにルールが適用されなかった。
- この場合、ワイルドカード（複数のファイルやディレクトリを柔軟に指定するための記号）を使用し、`app/controllers/*.rb` と記述することで、ようやく対象ファイルにルールを適用できた。
- Rubyのコードスタイルとして、if文で条件を満たさない場合に処理を抜けるようになっているときは、ガード節を使うべきというものがある。
- ガード節とは、条件に当てはまった際は早めに処理が終わるように`return`などを使って処理を抜けるようにするための書き方。
この書き方を行うことで、コードが読みやすくなる、複雑な`if-else`を減らせるためネストが浅くなる、条件が明確にわかれるためバグを防ぎやすくなるといった効果がある。
- Rubyの構文で後置if構文というものがある。if条件を処理の後ろに書くことで、1行でシンプルに条件付き処理を記述できるスタイル。
シンプルにはなるが、知らないと書かれているコードに対して頭が混乱する。
- `()` や `%i[]`といった構造で空白が省略される理由は、中の要素が区切られているか、グループなのか、という見た目の一貫性が崩れ可読性にすぐれないため。
- `{}` を使ったハッシュリテラルでは、シンボル・ネストしたハッシュ・配列など、複雑な構造を値として扱うことが多い。
そのため、キーと値の間の空白（例：`{ key: value }`）を省略すると、構造が詰まって見えて視認性が下がりやすい。
空白を適切に入れることで、各ペアの見分けがつきやすくなり、可読性が向上するため、RuboCopなどのスタイルガイドでも空白の挿入が推奨されている。
- 正規表現にマッチした結果を `$1` や `$2` などのグローバル変数で扱っていると、どの正規表現に対応する値なのかが不明瞭になりやすく、コードの意図が伝わりづらくなってしまう。その結果、バグの原因にもなりやすい。
- そのため、代わりに `::Regexp.last_match(n)` を使うことで、直前にマッチした正規表現の「n 番目のキャプチャグループ」を明示的に取得できるようになる。
意図が明確な、読みやすく安全なコードにするために、このメソッドの使用が推奨されている。

# 現状の問題点
- コードスタイルの修正箇所が非常に多く、対応に時間がかかっている。
## 今後の対応
- 修正箇所（611個）と多いため、簡単なルール（行の最後の余白や文字列をダブルクォートからシングルクォートに置換）に対しては自動修正を適用する予定。
